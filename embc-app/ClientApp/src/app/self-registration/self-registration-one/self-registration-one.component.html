<div [formGroup]="form">
  <h2 class="step">STEP 1</h2>
  <h1 class="mt-0">Register as an Evacuee</h1>

  <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed lacinia suscipit ligula sit amet pulvinar.
    Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Aenean efficitur et arcu
    a fringilla.</p>

  <div class="feature-block">
    <h3>Restriction<span style="color:#CC0000;"> *</span></h3>
    <p>Concerned family
      and friends may inquire about you and your family because of the emergency. We would like to provide these
      people with some information about you. May we disclose your location and the contact information for you
      and your family members?</p>
    <div class="form-check">
      <input class="form-check-input" type="radio" value="true" formControlName="restrictedAccess">
      <label class="form-check-label">Yes</label>
    </div>
    <div class="form-check">
      <input class="form-check-input" type="radio" value="false" formControlName="restrictedAccess">
      <label class="form-check-label">No</label>
    </div>
  </div>

  <h3 class="blue-header">EVACUEE DETAILS</h3>
  <section class="padded-section" formGroupName="headOfHousehold">
    <div class="row">
      <app-form-field class="col-md-8" required="true">
        <label>Last Name</label>
        <input class="form-control" type="text" formControlName="lastName">
      </app-form-field>
    </div>
    <div class="row">
      <app-form-field class="col-md-8" required="true">
        <label>First Name</label>
        <input class="form-control" type="text" formControlName="firstName">
      </app-form-field>
    </div>
    <div class="row">
      <app-form-field class="col-md-3">
        <label>Initial</label>
        <input class="form-control" type="text" formControlName="initials">
      </app-form-field>
      <app-form-field class="col-md-5">
        <label>Nickname</label>
        <input class="form-control" type="text" formControlName="nickname">
      </app-form-field>
    </div>
    <div class="row">
      <app-form-field class="col-md-2" required="true">
        <label>Gender</label>
        <select class="form-control" formControlName="gender">
          <option [ngValue]="null">Please select--</option>
          <option value="male">Male</option>
          <option value="female">Female</option>
          <option value="other">Other</option>
        </select>
      </app-form-field>
      <app-form-field class="col-md-3" required="true">
        <label>Date of Birth</label>
        <input class="form-control" type="date" formControlName="dob">
      </app-form-field>
    </div>
  </section>

  <h3 class="blue-header">EVACUEE FAMILY INFORMATION
    <app-font-awesome-icon icon="info-circle" className="ml-3 text-white"></app-font-awesome-icon>
  </h3>
  <section class="padded-section">
    <p>Are you registering immediate family members who live in the same household with you?</p>
    <div class="form-group">
      <div class="form-check">
        <input class="form-check-input" type="radio" value="yes" formControlName="registeringFamilyMembers">
        <label class="form-check-label">Yes</label>
      </div>
      <div class="form-check">
        <input class="form-check-input" type="radio" value="yes-later" formControlName="registeringFamilyMembers">
        <label class="form-check-label">Yes, but I'd like to register them when I get to the
          Reception Center</label>
      </div>
      <div class="form-check">
        <input class="form-check-input" type="radio" value="no" formControlName="registeringFamilyMembers">
        <label class="form-check-label">No</label>
      </div>
    </div>
    <div *ngIf="ui.showFamilyMembers()" class="feature-block">
      <div class="family-members__list" formArrayName="familyMembers">
        <div class="family-members__item" *ngFor="let m of familyMembers.controls; index as i;" [formGroupName]="i">
          <!-- TODO: Refactor into sub-component -->
          <div class="row">
            <app-form-field class="col-md-6" required="true">
              <label>Last Name</label>
              <input class="form-control" type="text" formControlName="lastName">
            </app-form-field>
            <div class="form-check col-md-6">
              <input class="form-check-input" type="checkbox" formControlName="sameLastNameAsEvacuee" [value]="true">
              <label class="form-check-label">Same as main applicant</label>
            </div>
          </div>
          <div class="row">
            <app-form-field class="col-md-6" required="true">
              <label>First Name</label>
              <input class="form-control" type="text" formControlName="firstName">
            </app-form-field>
            <app-form-field class="col-md-3">
              <label>Initial</label>
              <input class="form-control" type="text" formControlName="initials">
            </app-form-field>
          </div>
          <div class="row">
            <app-form-field class="col-md-6">
              <label>Relationship</label>
              <!-- <input class="form-control" type="text" formControlName="relationshipToEvacuee"> -->
              <select class="form-control" formControlName="relationshipToEvacuee">
                <option [ngValue]="null">Please select--</option>
                <option [value]="item.code" *ngFor="let item of relationshipTypes$ | async">{{item.description}}
                </option>
              </select>
            </app-form-field>
            <app-form-field class="col-md-2" required="true">
              <label>Gender</label>
              <select class="form-control" formControlName="gender">
                <option [ngValue]="null">Please select--</option>
                <option value="male">Male</option>
                <option value="female">Female</option>
                <option value="other">Other</option>
              </select>
            </app-form-field>
            <app-form-field class="col-md-3" required="true">
              <label>Date of Birth</label>
              <input class="form-control" type="date" formControlName="dob">
            </app-form-field>
          </div>
        </div>
      </div>
      <div class="family-members__actions clearfix">
        <a [routerLink]="" class="float-left" (click)="removeFamilyMember()">
          <app-font-awesome-icon icon="times"></app-font-awesome-icon><span class="ml-2">Remove</span>
        </a>
        <a [routerLink]="" class="float-right" (click)="addFamilyMember()">
          <app-font-awesome-icon icon="plus-circle"></app-font-awesome-icon>
          <span class="ml-2">Add another contact</span>
        </a>
      </div>
    </div>
  </section>

  <h3 class="blue-header">PRIMARY RESIDENCE &amp; CONTACT DETAILS
    <app-font-awesome-icon icon="info-circle" className="ml-3 text-white"></app-font-awesome-icon>
  </h3>
  <section class="padded-section">
    <div class="form-group d-flex flex-row">
      <p class="m-0 mr-4">Is your primary residence within BC</p>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" formControlName="primaryResidenceInBC" [value]="true">
        <label class="form-check-label">Yes</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" formControlName="primaryResidenceInBC" [value]="false">
        <label class="form-check-label">No</label>
      </div>
    </div>
    <section *ngIf="ui.showPrimaryAddressSection()" class="feature-block">
      <section class="blurb" *ngIf="ui.showStrandedTravellerBlurb()">
        <h4 class="text-danger">Stranded Traveller</h4>
        <p class="text-danger">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed lacinia suscipit ligula sit
          amet pulvinar. Vestibulum ante ipsum primis in faucibus orci.</p>
      </section>
      <app-address-selector [parent]="primaryResidence" [withinBC]="primaryResidenceInBC.value">
      </app-address-selector>
      <section>
        <div class="row">
          <app-form-field class="col-md-6">
            <label>Telephone / Mobile Number (10 digits)</label>
            <input class="form-control" type="text" placeholder="xxx xxx xxxx" formControlName="phoneNumber">
          </app-form-field>
          <app-form-field class="col-md-6">
            <label>Alternate Telephone / Mobile Number</label>
            <input class="form-control" type="text" placeholder="xxx xxx xxxx" formControlName="phoneNumberAlt">
          </app-form-field>
        </div>
        <div class="row">
          <app-form-field class="col-md-8" required="true">
            <label>Email Address</label>
            <input class="form-control" type="text" formControlName="email">
          </app-form-field>
        </div>
      </section>
    </section>
  </section>

  <h3 class="blue-header">MAILING ADDRESS</h3>
  <section class="padded-section">
    <p>Is your mailing address different from your primary residence?</p>
    <div class="form-group">
      <div class="form-check">
        <input class="form-check-input" type="radio" formControlName="hasMailingAddress" [value]="true">
        <label class="form-check-label">Yes</label>
      </div>
      <div class="form-check">
        <input class="form-check-input" type="radio" formControlName="hasMailingAddress" [value]="false">
        <label class="form-check-label">No</label>
      </div>
    </div>
    <section *ngIf="ui.showMailingAddressSelector()" class="feature-block">
      <div class="form-group d-flex flex-row">
        <p class="m-0 mr-4">Is your mailing address within BC</p>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" formControlName="mailingAddressInBC" [value]="true">
          <label class="form-check-label">Yes</label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" formControlName="mailingAddressInBC" [value]="false">
          <label class="form-check-label">No</label>
        </div>
      </div>
      <app-address-selector *ngIf="ui.showMailingAddressSection()" [parent]="mailingAddress"
        [withinBC]="mailingAddressInBC.value"></app-address-selector>
    </section>
  </section>

  <div class="mt-5 space-between">
    <section>
      <a [routerLink]="">
        <app-font-awesome-icon icon="times"></app-font-awesome-icon>
        <span class="ml-2">Cancel &amp; Close</span>
      </a>
    </section>
    <section>
      <button class="btn btn-primary" (click)="next()">NEXT</button>
    </section>
  </div>
</div>

<div class="mt-5">
  <h4>Form State</h4>
  <pre>{{ this.form.value | json }}</pre>
</div>

<div class="mt-5">
  <h4>Current Registration</h4>
  <pre>{{ this.registration | json }}</pre>
</div>
